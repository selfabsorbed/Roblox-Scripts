game.Players.LocalPlayer.PlayerGui.Fade.Enabled = false

local Checkpoints = {}

for _, Checkpoint in workspace.ObbyCheckpoints.NatureObby:GetChildren() do
	Checkpoints[Checkpoint:GetAttribute("Number")] = Checkpoint.Cylinder
end

local State = nil
game:GetService("ReplicatedStorage"):WaitForChild("MiscRemotes"):WaitForChild("ObbyEvent").OnClientEvent:Connect(function(state)
	if state == "SpawnObby" then
		State = "Start"
	elseif state == "DespawnObby" then
		State = "End"
	elseif state == "ClaimCheckpoint" then
		State = "Claimed"
	end
end)

repeat
	firetouchinterest(game.Players.LocalPlayer.Character.PrimaryPart, workspace.Portals.Portals.NatureObbyPortal.Teleport, 0)
	firetouchinterest(game.Players.LocalPlayer.Character.PrimaryPart, workspace.Portals.Portals.NatureObbyPortal.Teleport, 1)
	repeat task.wait() until State == "Start"
	State = nil

	for Number = 1, #Checkpoints do
		-- repeat
			firetouchinterest(game.Players.LocalPlayer.Character.PrimaryPart, Checkpoints[Number], 0)
			firetouchinterest(game.Players.LocalPlayer.Character.PrimaryPart, Checkpoints[Number], 1)
			game:GetService("RunService").Heartbeat:Wait()
		-- until State == "Claimed"
		-- State = nil
	end

	repeat task.wait() until State == "End"
	State = nil
until game.Players.LocalPlayer.plrStats.Obbies.NatureObby.Completions.Value >= 64
